<div class="container">
  <!-- Affichage du message d'erreur -->
  <div *ngIf="errorMessage" class="error-message">
    <p>{{ errorMessage }}</p>
  </div>

  <!-- √âtape 1: Email -->
  <div *ngIf="!emailSent && !emailVerified">
    <form (ngSubmit)="sendVerificationEmail()">
      <div class="input-group">
        <label for="email">Email</label>
        <input
          type="email"
          id="email"
          [(ngModel)]="formData.email"
          name="email"
          placeholder="exemple@domaine.com"
          required
        />
      </div>
      <button type="submit" class="submit-btn">Envoyer le code de v√©rification</button>
    </form>
    <!-- Si l'email existe d√©j√†, afficher le message et un lien pour se connecter -->
    <div *ngIf="emailExists">
      <p>Vous avez d√©j√† un compte ? <a href="/login">Connectez-vous ici</a>.</p>
    </div>
  </div>

  <!-- √âtape 2: Code de v√©rification avec compte √† rebours -->
  <div *ngIf="emailSent && !emailVerified" class="email-verification">
    <h2>V√©rification email</h2>
    <p class="info">Nous vous avons envoy√© un code de v√©rification sur <span>{{ formData.email }}</span></p>
    <form (ngSubmit)="verifyCode()">
      <div class="input-group">
        <input
          type="text"
          id="verificationCode"
          [(ngModel)]="verificationCode"
          name="verificationCode"
          placeholder="Entrez votre code de v√©rification"
          required
        />
      </div>

      <!-- Compte √† rebours affich√© -->
      <p class="countdown">Temps restant : <span>{{ countdownMinutes }} : {{ countdownSeconds }} </span></p>

      <button type="submit" class="submit-btn">V√©rifier le code</button>
    </form>
  </div>

  <!-- √âtape 3: Nom, T√©l√©phone, R√¥le, Photo de profil (apr√®s v√©rification du code) -->
  <div *ngIf="emailVerified && !additionalInfoProvided">
    <h1>Inscription</h1>

    <form (ngSubmit)="submitAdditionalInfo()">
      <div class="input-group">
        <label for="name">Nom & Pr√©nom</label>
        <input
          type="text"
          id="name"
          [(ngModel)]="formData.name"
          name="name"
          placeholder="Votre nom complet"
          required
        />
      </div>

      <div class="input-group">
        <label for="phone">Num√©ro de t√©l√©phone</label>
        <input
          type="text"
          id="phone"
          [(ngModel)]="formData.phone"
          name="phone"
          placeholder="77 000 00 00"
          required
        />
      </div>

      <div class="input-group">
        <label for="role">R√¥le</label>
        <select id="role" [(ngModel)]="formData.role" name="role" required>
          <option value="" disabled selected>S√©lectionnez un r√¥le</option>
          <option value="organizer">Organisateur</option>
          <option value="participant">Participant</option>
        </select>
      </div>

      <!-- Photo de profil (optionnelle) -->
      <div class="input-group">
        <label for="profilePic">Photo de profil (optionnel)</label>
        <div class="profile-pic-upload">
          <input type="file" id="profilePic" name="profilePic" (change)="onFileSelected($event)" />
          <label for="profilePic">
            <span>üì§ T√©l√©verser votre photo de profil</span>
          </label>
        </div>
      </div>

      <button type="submit" class="submit-btn">Suivant</button>
    </form>
  </div>

  <!-- √âtape 4: Mot de passe (apr√®s avoir soumis les informations suppl√©mentaires) -->
  <div *ngIf="additionalInfoProvided">
    <h1>Inscription</h1>

    <form (ngSubmit)="register()">
      <div class="input-group">
        <label for="password">Mot de passe</label>
        <input
          type="password"
          id="password"
          [(ngModel)]="formData.password"
          name="password"
          placeholder="*******"
          required
        />
      </div>

      <div class="input-group">
        <label for="password-confirm">Confirmation mot de passe</label>
        <input
          type="password"
          id="password-confirm"
          [(ngModel)]="formData.password_confirmation"
          name="password_confirmation"
          placeholder="*******"
          required
        />
      </div>

      <button type="submit" class="submit-btn">S'inscrire</button>
    </form>
  </div>
</div>
